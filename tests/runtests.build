<?xml version="1.0"?>
<project name="Test Collecton" default="runtests" basedir=".">
	<target name="runtests">
		<property name="failedtests" value=""/>
		<mkdir dir="../testresults"/>
		<foreach item="File" property="testconfig">
			<in>
				<items>
					<include name="*.ini"/>
				</items>
			</in>
			<do>
				<property name="testfile" value="${path::get-file-name(testconfig)}"/>
				<echo message="Running ${testfile}"/>
				<trycatch>
					<try>
						<exec program="SilverSim.Main.exe" basedir="../bin" workingdir="../bin" managed="true">
							<arg value="-m=testing"/>
							<arg value="-c"/>
							<arg value="../tests/${testfile}"/>
						</exec>
					</try>
					<catch>
						<property name="failedtests" value="${failedtests}
${testfile}"/>
					</catch>
				</trycatch>
			</do>
		</foreach>
		<fail message="Failed tests:${failedtests}" if="${failedtests!=''}"/>
	</target>
</project>